(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b161fea0"],{"207d":function(e,s,t){},"770c":function(e,s,t){"use strict";t.r(s);var i=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("h1",{attrs:{id:"greetings"}},[e._v("你好,")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.message},on:{input:function(s){s.target.composing||(e.message=s.target.value)}}}),t("el-button",{nativeOn:{click:function(s){return s.preventDefault(),e.sendMessage(s)}}},[e._v("发送")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.buttonVisible,expression:"buttonVisible"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{id:"match"},nativeOn:{click:function(s){return s.preventDefault(),e.match(s)}}},[e._v("点击匹配")]),t("div",{staticClass:"textarea scroll",attrs:{id:"responseContent"}}),t("div",{attrs:{id:"output"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.questionVisible,expression:"questionVisible"}]},[t("div",[e._v("题目"+e._s(this.pageNumber+1)+" / "+e._s(this.questions.length))]),t("div",[e._v(e._s(this.title))]),t("el-radio-group",{model:{value:e.radio,callback:function(s){e.radio=s},expression:"radio"}},[t("ul",{staticClass:"question"},[t("li",[t("el-radio",{attrs:{label:0}},[e._v("A. "+e._s(this.answerA))])],1),t("li",[t("el-radio",{attrs:{label:1}},[e._v("B. "+e._s(this.answerB))])],1),t("li",[t("el-radio",{attrs:{label:2}},[e._v("C. "+e._s(this.answerC))])],1),t("li",[t("el-radio",{attrs:{label:3}},[e._v("D."+e._s(this.answerD))])],1)])]),t("el-button",{staticClass:"question",nativeOn:{click:function(s){return s.preventDefault(),e.submit(s)}}},[e._v("提交")])],1),t("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.questionVisible,expression:"questionVisible"}],attrs:{"text-inside":!0,"show-text":!1,"stroke-width":20,percentage:e.getTime(),color:e.colors}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.timeVisible,expression:"timeVisible"}]},[e._v("总用时:"+e._s(this.answeringTotalTime.toFixed(2)))]),t("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.questionVisible,expression:"questionVisible"}],attrs:{type:"circle",percentage:e.getRate()}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.resultVisible,expression:"resultVisible"}]},[t("div",[t("div",[e._v("题目总数: "+e._s(this.questions.length))]),t("div",[e._v("回答正确: "+e._s(this.correctNumber))]),t("div",[e._v("回答错误: "+e._s(this.wrongNumber))]),t("div",[e._v("正确率: ")]),t("el-progress",{attrs:{type:"circle",percentage:e.getRate()}})],1),t("el-button",{nativeOn:{click:function(s){return s.preventDefault(),e.exitAnswer(s)}}},[e._v("结束答题")])],1)],1)},n=[],a=t("c24f"),r=t("5f87"),o=t("b775"),c=t("5c96");function u(){return Object(o["a"])({url:"/api/battle/questions",method:"get"})}var l={name:"Socket",data:function(){return{message:"",socket:"",me:null,loading:!1,buttonVisible:!0,questionVisible:!1,resultVisible:!1,timeVisible:!1,questions:[],radio:-1,correctNumber:0,wrongNumber:0,title:"",answerA:"",answerB:"",answerC:"",answerD:"",pageNumber:0,totalTime:100,answeringTotalTime:0,colors:[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#5cb87a",percentage:60},{color:"#1989fa",percentage:80},{color:"#6f7ad3",percentage:100}],clock:"",PRIVATE_CHAT_MESSAGE_CODE:1,GROUP_CHAT_MESSAGE_CODE:2,PING_MESSAGE_CODE:3,SYSTEM_MESSAGE_CODE:5,MATCHING_MESSAGE_CODE:6,MATCH_SUCCESS_MESSAGE_CODE:7,MATCH_REVOKE_CODE:8,LOGIN_CODE:1e3,LOGOUT_CODE:1001}},destroyed:function(){this.quitSend(),location.reload()},created:function(){this.initMe()},methods:{initMe:function(){var e=this;this.me=new Object,Object(a["b"])(Object(r["a"])()).then((function(s){e.me.username=s.data.userNickname,e.me.userId=s.data.userName,e.websocket()}))},websocket:function(){var e=this;return window.WebSocket?(this.socket=new WebSocket(o["b"]+this.me.userId),console.log("当前用户是"+this.me.username),document.getElementById("greetings").append(decodeURI(decodeURI(this.me.username))),this.socket.onmessage=function(s){var t=JSON.parse(s.data);switch(console.log(JSON.stringify(t)),t.code){case e.GROUP_CHAT_MESSAGE_CODE:document.getElementById("output").append(t.msg);break;case e.SYSTEM_MESSAGE_CODE:break;case e.PING_MESSAGE_CODE:e.sendPong();break;case e.PRIVATE_CHAT_MESSAGE_CODE:break;case e.MATCH_SUCCESS_MESSAGE_CODE:c["MessageBox"].close(),e.loading=!1,e.buttonVisible=!1,e.timeVisible=!0,e.$message({type:"success",message:"匹配成功"}),e.getQuestion();break;case e.MATCH_REVOKE_CODE:c["MessageBox"].close(),e.loading=!1,e.$message({type:"error",message:"没有找到对手捏，请稍后重新匹配~"})}},this.socket.onopen=function(){e.loginSend()},this.socket.onclose=function(){e.quitSend()},!0):(alert("您的浏览器不支持WebSocket"),!1)},sendPong:function(){var e={code:4};this.send(JSON.stringify(e))},send:function(e){window.WebSocket&&(this.socket.readyState===WebSocket.OPEN||(this.socket.readyState=WebSocket.OPEN),this.socket.send(e))},loginSend:function(){var e={};e.code=this.LOGIN_CODE,e.username=this.me.username,e.userId=this.me.userId,this.send(JSON.stringify(e))},quitSend:function(){var e={};e.code=this.LOGOUT_CODE,e.username=this.me.username,e.userId=this.me.userId,this.send(JSON.stringify(e))},sendMessage:function(){if(""!==this.message&&null!=this.message){var e={};e.code=this.GROUP_CHAT_MESSAGE_CODE,e.username=this.me.username,e.msg=this.message,e.sendUserId=this.me.userId,this.send(JSON.stringify(e))}else alert("信息不能为空~")},match:function(){var e=this;this.loading=!0,c["MessageBox"].confirm("匹配中......","对战练习",{confirmButtonText:"隐藏",cancelButtonText:"取消",type:"info"}).then((function(){e.$message({type:"info",message:"正在帮您匹配，匹配框已帮您自动隐藏"})})).catch((function(){e.loading=!1,e.revokeMatch(),e.$message({type:"error",message:"已取消匹配"})}));var s={};s.code=this.MATCHING_MESSAGE_CODE,s.username=this.me.username,s.sendUserId=this.me.userId,console.log(JSON.stringify(s)),this.send(JSON.stringify(s))},revokeMatch:function(){var e={};e.code=this.MATCH_REVOKE_CODE,e.username=this.me.username,e.sendUserId=this.me.userId,console.log(JSON.stringify(e)),this.send(JSON.stringify(e))},getQuestion:function(){var e=this;u().then((function(s){e.questions=s.questions,e.pageNumber=0,e.correctNumber=0,e.wrongNumber=0,e.answeringTotalTime=0,e.title=e.questions[e.pageNumber].title,e.answerA=e.questions[e.pageNumber].answerA,e.answerB=e.questions[e.pageNumber].answerB,e.answerC=e.questions[e.pageNumber].answerC,e.answerD=e.questions[e.pageNumber].answerD,e.questionVisible=!0,e.countDown()}))},submit:function(){var e;switch(this.radio){case 0:e="A";break;case 1:e="B";break;case 2:e="C";break;case 3:e="D";break;default:e=NaN}e===this.questions[this.pageNumber]["correctAnswer"]?(this.correctNumber++,this.$message({message:"恭喜你，回答成功",type:"success"})):(this.wrongNumber++,this.$message.error("很遗憾，回答失败")),this.nextQuestion()},nextQuestion:function(){window.clearInterval(this.clock),this.radio=-1,this.totalTime=100;var e=this.questions.length,s=this.pageNumber+1;s>=e?this.finishAnswer():(this.pageNumber++,this.title=this.questions[this.pageNumber].title,this.answerA=this.questions[this.pageNumber].answerA,this.answerB=this.questions[this.pageNumber].answerB,this.answerC=this.questions[this.pageNumber].answerC,this.answerD=this.questions[this.pageNumber].answerD,this.countDown())},getRate:function(){return this.correctNumber/this.questions.length*100},finishAnswer:function(){this.questionVisible=!1,this.resultVisible=!0,window.clearInterval(this.clock)},exitAnswer:function(){this.resultVisible=!1,this.questionVisible=!1,this.timeVisible=!1,this.$message({message:"感谢参与本轮答题匹配，欢迎下次再来~",type:"success"}),this.buttonVisible=!0},countDown:function(){var e=this;this.content=this.totalTime,this.clock=window.setInterval((function(){e.totalTime--,e.answeringTotalTime+=.2,e.content=e.totalTime,e.totalTime<1&&(window.clearInterval(e.clock),e.totalTime=100,e.submit())}),200)},getTime:function(){return this.totalTime}}},m=l,h=(t("c554"),t("2877")),d=Object(h["a"])(m,i,n,!1,null,"1c69ea40",null);s["default"]=d.exports},c554:function(e,s,t){"use strict";t("207d")}}]);